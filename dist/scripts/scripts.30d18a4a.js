"use strict";angular.module("159webApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","uiGmapgoogle-maps"]).constant("config",{urlApi:"http://104.236.241.155:9020/api/",urlImg:"http://104.236.241.155:9020",formatoFecha:"dd/MM/yyyy"}).config(["$routeProvider","uiGmapGoogleMapApiProvider",function(a,b){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/activity/list",{templateUrl:"views/activity/activities.html",controller:"ActivitiesCtrl"}).when("/activity/detail",{templateUrl:"views/activity/activitydetail.html",controller:"ActivitydetailCtrl"}).when("/activity/create",{templateUrl:"views/activity/createactivity.html",controller:"CreateactivityCtrl"}).when("/person/register",{templateUrl:"views/person/registerperson.html",controller:"RegisterpersonCtrl"}).when("/community/list",{templateUrl:"views/community/communities.html",controller:"CommunitiesCtrl"}).when("/community/create",{templateUrl:"views/community/createcommunity.html",controller:"CreatecommunityCtrl"}).otherwise({redirectTo:"/"}),b.configure({key:"AIzaSyBT3ghh6hRocWTe3i0aOWlqnNOUUzMcFok",v:"3.17",libraries:"weather,geometry,visualization"})}]),angular.module("159webApp").controller("MainCtrl",["$scope",function(a){}]),angular.module("159webApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("159webApp").controller("ActivitydetailCtrl",["$scope","$rootScope","$http","config","uiGmapGoogleMapApi",function(a,b,c,d,e){a.activity=b.activity,b.activityAccept=0,a.viewMap=!1;var f=0,g=0;a.comments=[],a.point={},a.like={yes:0,no:0},a.acept={val:0,cssClass:"danger"},a.attend={yes:0,no:0},a.assistant={val:0,cssClass:"danger"},c({method:"GET",url:d.urlApi+"activities/4/"}).success(function(b){a.activity=b,a.point.latitude=b.latitude,a.point.longitude=b.longitude,a.marker.latitude=b.latitude,a.marker.longitude=b.longitude,a.initMap()}),a.likeActivity=function(){a.like.yes++,h()},a.noLikeActivity=function(){a.like.no++,h()},a.attendActivity=function(){a.attend.yes++,i()},a.noAttendActivity=function(){a.attend.no++,i()},a.changeViewMap=function(){a.viewMap=!a.viewMap},a.initMap=function(){e.then(function(b){a.maps=b,a.map={center:{latitude:14.613411429802484,longitude:-90.53492810058594},zoom:16,bounds:{}}})},a.marker={id:1,coor:{latitude:a.point.latitude,longitude:a.point.longitude},options:{draggable:!1,labelContent:"lat: "+a.point.latitude+" lon: "+a.point.longitude,labelAnchor:"100 0",labelClass:"label label-success"},animate:1,events:{dragend:function(b,c,d){a.point.latitude=b.getPosition().lat(),a.point.longitude=b.getPosition().lng()}}};var h=function(){(f>=0||99>=f)&&(f=Math.round((a.like.yes-a.like.no)/a.like.yes*100),f>=66?a.acept.cssClass="success":f>=33&&66>=f?a.acept.cssClass="warning":33>f&&(a.acept.cssClass="danger"),a.acept.val=f)},i=function(){(g>=0||99>=g)&&(g=Math.round((a.attend.yes-a.attend.no)/a.activity.minimum_assistant*100),g>=66?a.assistant.cssClass="success":g>=33&&66>=f?a.assistant.cssClass="warning":33>g&&(a.acept.cssClass="danger"),a.assistant.val=g)};a.addComment=function(){var b={date:new Date,content:a.newComment};a.comments.push(b),a.newComment=""}}]),angular.module("159webApp").controller("RegisterpersonCtrl",["$scope","$http","config",function(a,b,c){a.result={titl:"","class":"",message:""},a.send=!1,a.changeSend=function(){a.send=!1},a.registerPerson=function(){var d=$.param({first_name:a.person.name,last_name:a.person.lastName,phone:a.person.phone,direction:a.person.direction,birth_date:a.person.dateBirth,email:a.person.eMail,id_number:a.person.numberId,sex:a.person.sex,document_type:a.person.typeId,password:a.person.password,town:1});b({method:"POST",url:c.urlApi+"persons/",data:d,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){a.result.titl="Exito!",a.result["class"]="success",a.result.message="Registro exitoso.",a.send=!0,a.person={}}).error(function(b){a.result.titl="Error",a.result["class"]="danger",a.result.message="Error al registrar.",a.send=!0})}}]),angular.module("159webApp").controller("CommunitiesCtrl",["$scope","$http","$rootScope","config",function(a,b,c,d){a.ip=d.urlImg,b({method:"GET",url:d.urlApi+"communities/"}).success(function(b){a.communities=b}),a.addActivity=function(a){c.communityId=a.id,c.communityName=a.name,window.location="#/activity/create/"}}]),angular.module("159webApp").controller("CreatecommunityCtrl",["$scope","$http","config",function(a,b,c){a.result={titl:"","class":"",message:""},a.send=!1,a.objectives=[],a.changeSend=function(){a.send=!1},a.addObjective=function(b){a.objectives.push(b),a.objective=""},a.remObjective=function(b){var c=a.objectives.indexOf(b);a.objectives.splice(c,1)},a.sectors=[],a.serctor={};var d=function(){b({method:"GET",url:c.urlApi+"sectors/"}).success(function(b){a.sectors=b}),a.sector=a.sectors[3]};d(),a.createCommunity=function(){var d=$.param({name:a.community.name,purpose:a.community.purpose,idSector:a.community.sector.id,idPerson:4,objectives:JSON.stringify(a.objectives)});b({method:"POST",url:c.urlApi+"communities/",data:d,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){a.result.titl="Exito!",a.result["class"]="success",a.result.message="Tu comunidad ha sido creada.",a.send=!0,a.community={},a.objectives=[],a.objective=""}).error(function(b){a.result.titl="Error",a.result["class"]="danger",a.result.message="No hemos podido crear tu comunidad.",a.send=!0})}}]),angular.module("159webApp").controller("CreateactivityCtrl",["$scope","$http","$rootScope","config","uiGmapGoogleMapApi",function(a,b,c,d,e){a.community={id:c.communityId,name:c.communityName},a.point={latitude:14.613411429802484,longitude:-90.53492810058594},e.then(function(b){a.maps=b,a.map={center:{latitude:a.point.latitude,longitude:a.point.longitude},zoom:16,bounds:{}}}),a.marker={id:1,coor:{latitude:a.point.latitude,longitude:a.point.longitude},options:{draggable:!0,labelContent:"lat: "+a.point.latitude+" lon: "+a.point.longitude,labelAnchor:"100 0",labelClass:"label label-success"},animate:1,events:{dragend:function(b,c,d){a.point.latitude=b.getPosition().lat(),a.point.longitude=b.getPosition().lng()}}},a.result={titl:"","class":"",message:""},a.send=!1,a.objectives=[],a.changeSend=function(){a.send=!1},a.createActivity=function(){null==a.community.id&&(a.community.id=6);var c=$.param({name:a.activity.name,description:a.activity.description,begin_date:new Date(a.activity.beginDate).toISOString(),end_date:new Date(a.activity.endDate).toISOString(),latitude:a.point.latitude,longitude:a.point.longitude,minimum_assistant:a.activity.assistant,town:1,community:a.community.id});b({method:"POST",url:d.urlApi+"activities/",data:c,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(b){a.result.titl="Exito!",a.result["class"]="success",a.result.message="Tu actividad ha sido creada.",a.send=!0,a.activity={},a.point={latitude:14.613411429802484,longitude:-90.53492810058594}}).error(function(b){a.result.titl="Error",a.result["class"]="danger",a.result.message="No hemos podido crear tu actividad.",a.send=!0})}}]),angular.module("159webApp").controller("ActivitiesCtrl",["$scope","$http","$rootScope","$window","config",function(a,b,c,d,e){a.api=e.urlImg,b({method:"GET",url:e.urlApi+"activities/"}).success(function(b){a.activities=b}),a.verActividad=function(a){c.activity=a,d.location="#/activity/detail"}}]);